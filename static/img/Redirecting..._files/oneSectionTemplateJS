routerPages.controller("oneSectionTemplateController",["$document","$scope","$timeout","$interval","$window","$http","templatesSharedLogic","pamAjaxService","beResponseDataService","rpsEnums","rpsProgressBarService","Theme_Translations","oneSectionTemplateService","dynamicVariablesService","localStorageService",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){function p(n){n.data.IS&&(window.location.href=n.data.RU)}function w(){y.captchaEnabled=e.getCaptchaEnabled();window.cptResponse=function(n){o.validateCpt(n,a.getESU(),a.getGID(),p)};e.addRecaptchaClickEvent("survey-button")}function b(){var n=y.progressBar=c.getVm(c.names.diTargetSurveyLanding,l.TargetedSurveyLandingLoadingText),f=s.getPageType(),o;n.show=!PREVIEW_ONLY&&(f===h.ePageType.targetedSurveyLanding||f===h.ePageType.reroute);n.show&&(o=r(function(){n.value<100?n.value+=Math.floor(Math.random()*10+1):r.cancel(o)},1e3),t.$watch(function(){return a.getShouldAutoRedirect()},function(n){!e.getCaptchaEnabled()&&n&&i(function(){y.navigating||(y.navigating=!0,u.location.href=v.dynamicVariableMap.surveyurl)},s.getAutoRedriectTimeout()*1e3)}))}function k(){t.$watch(function(){return e.getCaptchaEnabled()},function(n){if(n)w();else{var t=document.getElementById("survey-button");t&&(t.onclick=function(){return y.navigating?!1:(y.navigating=!0,!0)})}})}function d(){var n=s.getPageType();n===h.ePageType.promotionalSessionExpired;v.registerToDVMapChange("PromotionalIncentiveBonusChange",function(){if(!v.dynamicVariableMap.promotionalincentivebonus){var n=angular.element("#PromotionalIncentiveMessage");n.length&&n.remove()}})}var y=this;y.navigating=!1;y.init=function(n){y.captchaEnabled=!1;s.init(n);e.init();b();k();y.showAmirButton=s.getPageType()===h.ePageType.surveyTerminated;d()};y.translations={loadingText:l.TargetedSurveyLandingLoadingText}}])